<!DOCTYPE html>
<html>

<head>
    <title>rps</title>
</head>

<body>
    <script>
        // Inclusive random number function
        function rand(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function computerPlay() {
            let pick = rand(0, 2);

            switch (pick) {
                case 0:
                    return 'rock';
                case 1:
                    return 'paper';
                default:
                    return 'scissors'
            }
        }

        function playRound(playerSelection, computerSelection) {
            playerSelection = playerSelection.toLowerCase();

            if (playerSelection != 'rock' &&
                playerSelection != 'paper' &&
                playerSelection != 'scissors') {
                return;
            }

            let winFlag = false;

            if (playerSelection == 'rock') {
                if (computerSelection == 'paper') {
                    winner = computerSelection;
                    loser = playerSelection;
                }
                else {
                    winner = playerSelection;
                    loser = computerSelection;
                    winFlag = true;
                }
            }
            else if (playerSelection == 'paper') {
                if (computerSelection == 'scissors') {
                    winner = computerSelection;
                    loser = playerSelection;
                }
                else {
                    winner = playerSelection;
                    loser = computerSelection;
                    winFlag = true;
                }
            }
            else {
                if (computerSelection == 'rock') {
                    winner = computerSelection;
                    loser = playerSelection
                }
                else {
                    winner = playerSelection;
                    loser = computerSelection;
                    winFlag = true;
                }
            }

            return winFlag;
        }

        function game(){
            let playerWins = 0;
            let computerWins = 0;
            const draw = 'It\'s a draw!';

            while(computerWins + playerWins < 5){
                let pick = prompt('Pick one: [Rock, paper, scissors]');
                let computerPick = computerPlay();

                if (pick === computerPick){
                    alert(draw);
                    continue;
                }

                let result = playRound(pick, computerPick);

                if(result === undefined) {
                    alert('You must pick either Rock, Paper, or Scissors!');
                    // loop again
                }
                else if(result){
                    alert("You won that round, " + pick + " beats " + computerPick);
                    playerWins++;
                }
                else{
                    alert("You lost that round, " + computerPick + " beats " + pick);
                    computerWins++;
                }
            }

            if (playerWins > computerWins){
                alert("Congrats, you won! Your beat the computer " + playerWins + " to " + computerWins);
            }
            else{
                alert("The computer beat you " + computerWins + " to " + playerWins);
            }

            confirm("Would you like to go again?") ? game() : undefined;
        }

        game();

    </script>
</body>

</html>